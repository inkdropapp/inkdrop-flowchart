{"version":3,"sources":["../src/index.js"],"names":["Flowchart","React","Component","componentDidMount","renderDiagram","componentDidUpdate","render","el","canvas","code","props","children","diagram","flowchart","parse","innerHTML","drawSVG","error","message","PropTypes","node","module","exports","activate","markdownRenderer","remarkCodeComponents","deactivate"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,SAAN,SAAwBC,KAAK,CAACC,SAA9B,CAAwC;AAItCC,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,aAAL;AACD;;AACDC,EAAAA,kBAAkB,GAAG;AACnB,SAAKD,aAAL;AACD;;AACDE,EAAAA,MAAM,GAAG;AACP,WAAO;AAAK,MAAA,SAAS,EAAC,oBAAf;AAAoC,MAAA,GAAG,EAAEC,EAAE,IAAK,KAAKC,MAAL,GAAcD;AAA9D,MAAP;AACD;;AACDH,EAAAA,aAAa,GAAG;AACd,QAAI;AACF,YAAMK,IAAI,GAAG,KAAKC,KAAL,CAAWC,QAAX,CAAoB,CAApB,CAAb;;AACA,YAAMC,OAAO,GAAGC,mBAAUC,KAAV,CAAgBL,IAAhB,CAAhB;;AACA,WAAKD,MAAL,CAAYO,SAAZ,GAAwB,EAAxB;AACAH,MAAAA,OAAO,CAACI,OAAR,CAAgB,KAAKR,MAArB;AACD,KALD,CAKE,OAAOS,KAAP,EAAc;AACd,WAAKT,MAAL,CAAYO,SAAZ,GAAyB;;;eAGhBE,KAAK,CAACC,OAAQ;;;OAHvB;AAOD;AACF;;AA5BqC;;gBAAlClB,S,eACe;AACjBW,EAAAA,QAAQ,EAAEQ,mBAAUC;AADH,C;;AA8BrBC,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,QAAQ,GAAG;AACT,QAAIC,yBAAJ,EAAsB;AACpBA,gCAAiBC,oBAAjB,CAAsCZ,SAAtC,GAAkDb,SAAlD;AACD;AACF,GALc;;AAOf0B,EAAAA,UAAU,GAAG;AACX,QAAIF,yBAAJ,EAAsB;AACpBA,gCAAiBC,oBAAjB,CAAsCZ,SAAtC,GAAkD,IAAlD;AACD;AACF;;AAXc,CAAjB","sourcesContent":["import PropTypes from 'prop-types'\nimport * as React from 'react'\nimport flowchart from 'flowchart.js'\nimport { markdownRenderer } from 'inkdrop'\n\nclass Flowchart extends React.Component {\n  static propTypes = {\n    children: PropTypes.node\n  }\n  componentDidMount() {\n    this.renderDiagram()\n  }\n  componentDidUpdate() {\n    this.renderDiagram()\n  }\n  render() {\n    return <div className=\"markdown-flowchart\" ref={el => (this.canvas = el)} />\n  }\n  renderDiagram() {\n    try {\n      const code = this.props.children[0]\n      const diagram = flowchart.parse(code)\n      this.canvas.innerHTML = ''\n      diagram.drawSVG(this.canvas)\n    } catch (error) {\n      this.canvas.innerHTML = `\n        <span class=\"ui error message mde-error-message\">\n          <div class=\"header\">Failed to render flowchart. Please check if the syntax is correct.</div>\n          <p>${error.message}</p>\n          <p><a href=\"https://flowchart.js.org/\" target=\"_blank\">How to write flowchart</a></p>\n        </span>\n      `\n    }\n  }\n}\n\nmodule.exports = {\n  activate() {\n    if (markdownRenderer) {\n      markdownRenderer.remarkCodeComponents.flowchart = Flowchart\n    }\n  },\n\n  deactivate() {\n    if (markdownRenderer) {\n      markdownRenderer.remarkCodeComponents.flowchart = null\n    }\n  }\n}\n"],"file":"index.js"}